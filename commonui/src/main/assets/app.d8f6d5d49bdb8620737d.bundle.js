!function(l){function e(e){for(var t,n,i=e[0],s=e[1],r=e[2],a=0,o=[];a<i.length;a++)n=i[a],u[n]&&o.push(u[n][0]),u[n]=0;for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(l[t]=s[t]);for(p&&p(e);o.length;)o.shift()();return d.push.apply(d,r||[]),c()}function c(){for(var e,t=0;t<d.length;t++){for(var n=d[t],i=!0,s=1;s<n.length;s++){var r=n[s];0!==u[r]&&(i=!1)}i&&(d.splice(t--,1),e=a(a.s=n[0]))}return e}var n={},u={0:0},d=[];function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return l[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=l,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="./";var t=window.webpackJsonp=window.webpackJsonp||[],i=t.push.bind(t);t.push=e,t=t.slice();for(var s=0;s<t.length;s++)e(t[s]);var p=i;d.push([149,1]),c()}({126:function(e,t,n){},127:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var i=n(12),u=n.n(i),s=n(3),r=n.n(s),a=n(1),o=n.n(a),l=(n(82),n(6)),c=n.n(l),d=n(7),p=n.n(d),h=n(8),v=n.n(h),w=n(9),f=n.n(w);window.chooseAnswer=function(e){},window.endQuestionnaireAnswer=function(e){},window.sendWinData=function(e){},window.abandonLottery=function(){},window.submitSign=function(){},window.closeWebview=function(){};var m,y=new(function(e){function t(){return r()(this,t),c()(this,p()(t).call(this))}return v()(t,e),o()(t,[{key:"chooseAnswer",value:function(e){window.chooseAnswer(e);try{window.WebViewJavascriptBridge.callHandler("chooseAnswer",e)}catch(e){}}},{key:"endQuestionnaireAnswer",value:function(e){window.endQuestionnaireAnswer(e);try{window.WebViewJavascriptBridge.callHandler("endQuestionnaireAnswer",e)}catch(e){}}},{key:"sendWinData",value:function(e){window.sendWinData(e);try{window.WebViewJavascriptBridge.callHandler("sendWinData",e)}catch(e){}}},{key:"abandonLottery",value:function(){window.abandonLottery();try{window.WebViewJavascriptBridge.callHandler("abandonLottery")}catch(e){}}},{key:"submitSign",value:function(){window.submitSign();try{window.WebViewJavascriptBridge.callHandler("submitSign")}catch(e){}}},{key:"closeWebview",value:function(){window.closeWebview();try{window.WebViewJavascriptBridge.callHandler("closeWebview")}catch(e){}}}]),t}(f.a));window.updateNewQuestion=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("updateNewQuestion",e),t("收到答题信息")},window.hasChooseAnswer=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("hasChooseAnswer",e),t("收到答题结果:"+e)},window.testQuestion=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("extraQuestionMessageHandler",e),t("收到额外消息:"+e)},window.startQuestionNaire=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("startQuestionNaire",e),t("收到问卷信息:"+e)},window.stopQuestionNaire=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("stopQuestionNaire",e),t("收到问卷结束:"+e)},window.startLottery=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("startLottery",e),t("收到抽奖开始:"+e)},window.stopLottery=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("stopLottery",e),t("收到抽奖结束:"+e)},window.startSign=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("startSign",e),t("收到签到开始"+e)},window.stopSign=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("stopSign",e),t("收到签到结束"+e)},window.closeLotteryWinner=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("closeLotteryWinner",e),t("收到中奖中关闭窗口"+e)},window.bulletin=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("bulletin",e),t("收到公告"+e)},window.removeBulletin=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("removeBulletin",e),t("收到删除公告"+e)},window.onStartRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("onStartRecord",e),t("收到开始直播"+e)},window.onPauseRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("onPauseRecord",e),t("收到暂停直播"+e)},window.onExitRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};y.emit("onExitRecord",e),t("收到下课事件"+e)},m=function(e){e.init(function(e,t){}),y.emit("bridgeInit"),e.registerHandler("updateNewQuestion",window.updateNewQuestion),e.registerHandler("hasChooseAnswer",window.hasChooseAnswer),e.registerHandler("testQuestion",window.testQuestion),e.registerHandler("startQuestionNaire",window.startQuestionNaire),e.registerHandler("stopQuestionNaire",window.stopQuestionNaire),e.registerHandler("startLottery",window.startLottery),e.registerHandler("stopLottery",window.stopLottery),e.registerHandler("startSign",window.startSign),e.registerHandler("stopSign",window.stopSign),e.registerHandler("closeLotteryWinner",window.closeLotteryWinner),e.registerHandler("bulletin",window.bulletin),e.registerHandler("removeBulletin",window.removeBulletin),e.registerHandler("onStartRecord",window.onStartRecord),e.registerHandler("onPauseRecord",window.onPauseRecord),e.registerHandler("onExitRecord",window.onExitRecord)},window.WebViewJavascriptBridge?m(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){m(WebViewJavascriptBridge)},!1);var g=y,b=n(21),k=n.n(b),L=n(51),E=n.n(L),S=(n(126),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"),C={parseString:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim()},questionTypeTxt:function(e){return"C"===e?"多选":"单选"},isMultiSelect:function(e){return"C"===e},getStatusClass:function(e){var t="";switch(e){case"success":t="answer-right";break;case"error":t="answer-error";break;case"checked":t="answer-checked";break;case"selectRight":t="answer-right-select";break;case"normal":t="answer-normal";break;case"noselect":t="no-select"}return t},option:function(e){var t=e.ratio,n=void 0===t?"0":t,i=e.contain,s=void 0===i?"":i,r=e.type,a=void 0===r?"":r,o=e.index,l=e.count,c=void 0===l?"":l;return s?'\n    <li class="'.concat(this.getStatusClass(a),'" data-options="').concat(o,'">\n      <div class="ppt-answer-ratio" style="width:').concat(n,'"></div>\n      <div class="ppt-answer-option">').concat(o,". ").concat(this.parseString(s),'</div>\n      <span class="ppt-answer-count">').concat(c,"</span>\n    </li>\n    "):""},getOptions:function(t){for(var e=u()(t).filter(function(e){return-1!==e.indexOf("option")&&t[e]}).length,n="",i=0;i<e;i++)n+=this.option({contain:t["option".concat(i+1)],index:S[i],type:t["type".concat(i+1)],ratio:t["ratio".concat(i+1)]||0,count:t["result".concat(i+1)]});return n},card:function(e){var t="id-".concat((new Date).getTime()),n=document.createElement("div");return n.setAttribute("class","ppt-answer-card ".concat(e.tipsClass||"")),n.innerHTML='<div class="ppt-answer-head">\n      '.concat(e.tips,'\n      <span class="ppt-answer-close" data-type="close">×</span>\n    </div>\n    <div class="ppt-answer-contain">\n      <h3>【').concat(this.questionTypeTxt(e.type),"】").concat(this.parseString(e.title||e.name),'</h3>\n      <ul class="ppt-answer-list">\n        ').concat(this.getOptions(e),'\n      </ul>\n    </div>\n    <div class="ppt-answer-foot">\n      <span id="').concat(t,'" class="ppt-answer-btn ').concat(e.btnClass||"",'" data-type="').concat(e.submitType,'">').concat(e.btn,"</span>\n    </div>"),{el:n,id:t}},tips:function(e){var t=document.createElement("div");return t.textContent=e,t.classList.add("ppt-answer-tips"),t}},q=function(e){function n(e){var t;return r()(this,n),(t=c()(this,p()(n).call(this))).wrap=document.getElementById(e),t.el=null,t.btn=null,t.visible=!1,t.selectOptions=[],t.currentStatus={},t}return v()(n,e),o()(n,[{key:"updateNewQuestion",value:function(e){if("S"!==e.type){this.visible=!0,this.currentStatus={id:e.questionId,type:"commit"},this.selectOptions=[];var t=E()({submitType:"commit",btn:"提交答案",tips:"答题卡"},e);this.initElement(t,!0,e.questionId,C.isMultiSelect(t.type))}else this.emit("knowAnswer")}},{key:"hasChooseAnswer",value:function(e,t){if("S"!==t.type){this.visible=!0,this.currentStatus={id:t.questionId,type:"close"},t.result=t.data||t.result;var n=this.createResultData(e,t.result),i=this.getResultTips(e,t.result.answer,t.questionId),s=E()({submitType:"close",btn:"知道了",btnClass:"answer-primary",tips:i.tips,tipsClass:i.tipsClass},n,t,t.content);this.initElement(s,!1)}else this.emit("knowAnswer")}},{key:"stopQuestion",value:function(e){if("commit"===this.currentStatus.type&&this.currentStatus.id===e.questionId){this.currentStatus.type="stop";var t=C.getStatusClass("checked");this.btn.classList.remove("answer-primary"),this.btn.textContent="已截止",this.selectOptions=[],k()(this.el.querySelectorAll(".".concat(t))).forEach(function(e){e.classList.remove(t)})}}},{key:"initElement",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.removeCard();var s=C.card(e);this.el=s.el,this.wrap.appendChild(this.el),this.btn=document.getElementById(s.id),this.wrap.classList.add("answer-show"),this.bindEvent(t,n,i)}},{key:"getResultTips",value:function(e,t,n){var i=e||"",s="",r="";return i?r=i===t?(s="回答正确",C.getStatusClass("success")):(s="回答错误",C.getStatusClass("error")):s="未作答",{tips:s,tipsClass:r}}},{key:"createResultData",value:function(e,i){var s=this,r={},a=e.split("");return i.singleResult.forEach(function(e,t){var n=S[t];console.log(n),r["result".concat(t+1)]=e,r["ratio".concat(t+1)]=e/(i.total||1)*100+"%",r["type".concat(t+1)]=s.getAnswerType(i.answer,n,-1!==a.indexOf(n),e)}),r}},{key:"getAnswerType",value:function(e,t,n,i){var s=-1!==e.indexOf(t);return s&&n?"selectRight":!i&&s?"noselect":s?"success":!s&&n?"error":"normal"}},{key:"bindEvent",value:function(e,n){var s=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=null;this.el.addEventListener("click",function(e){var t=e.target.getAttribute("data-type");t&&("close"===t&&(s.removeCard(),s.emit("knowAnswer")),"commit"===t&&s.commit(n))}),e&&this.el.addEventListener("click",function(e){if("stop"!==s.currentStatus.type){for(var t=!0,n=e.target,i=null;t;){if(i=n.getAttribute("data-options")){t=!1;break}if(n===s.el){t=!1,n=null;break}if(!(n=n.parentNode))break}i&&(r?s.multiHandler(n,i):a=s.singleHandler(a,n,i))}})}},{key:"multiHandler",value:function(e,t){var n=C.getStatusClass("checked"),i=this.selectOptions.indexOf(t);-1<i?this.selectOptions.splice(i,1):this.selectOptions.push(t),0<this.selectOptions.length?this.btn.classList.add("answer-primary"):this.btn.classList.remove("answer-primary"),e.classList.toggle(n)}},{key:"singleHandler",value:function(e,t,n){var i=C.getStatusClass("checked");return e&&e.classList.remove(i),t.classList.add(i),this.selectOptions=[n],this.btn.classList.add("answer-primary"),t}},{key:"sortResult",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).sort().join("")}},{key:"commit",value:function(e){var t=this,n=this.sortResult(this.selectOptions);n&&(this.removeCard(),this.showTips("提交成功",1.5,function(){t.emit("chooseAnswer",{answerId:n,questionId:e})}))}},{key:"removeCard",value:function(){this.el&&(this.wrap.removeChild(this.el),this.el=null,this.wrap.classList.remove("answer-show"))}},{key:"showTips",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},s=C.tips(e);this.wrap.appendChild(s),this.wrap.classList.add("answer-show"),n&&setTimeout(function(){t.wrap.removeChild(s),t.wrap.classList.remove("answer-show"),i()},1e3*n)}}]),n}(f.a),T=n(50),A=n.n(T),N=(n(127),n(33)),x=n.n(N),H=n(34),I=n.n(H),Q={mainTmp:function(e){var t=this.getScore(e),n=t.totalScore,i=t.averageScore,s=document.createElement("div");return s.setAttribute("class","plv-questionnaire-result-container"),s.innerHTML='\n      <div class="qn-result-head">\n        <h4>'.concat(e.questionnaireTitle,'</h4>\n        <ul class="qn-head-right">\n          <li>\n            <p>提交量</p>\n            <span>').concat(e.total,"</span>\n          </li>\n          <li>\n            <p>总分</p>\n            <span>").concat(n,"</span>\n          </li>\n          <li>\n            <p>平均分</p>\n            <span>").concat(i,'</span>\n          </li>\n        </ul>\n      </div>\n      <div class="qn-result-body">\n        ').concat(this.getMainContent(e.data),'\n      </div>\n      <div class="qn-result-footer">\n        <button id="questionnaireResultClose">关闭</button>\n      </div>\n    ').trim(),s},qnContent:function(e){if("Q"===e.type)return'<div class="qn-body-list">非选择题结果不显示</div>';var t="",n="";switch(e.type){case"R":t="<p>单选</p>";break;case"C":t="<p>多选</p>";break;default:t="<p>问答</p>"}"Y"===e.scoreEnabled&&(n="\n        <span>".concat(Number(e.score),'分题</span>\n        <span class="result-average">平均分：').concat(I()(e.totalScore/e.total).toFixed(),"</span>\n      "));var i="Y"===e.required?'<span class="result-require">*</span>':"";return'\n      <div class="qn-body-list">\n        <div class="qn-body-title">\n          '.concat(t).concat(n,'\n        </div>\n        <h4 class="qn-body-name">').concat(e.name).concat(i,"</h4>\n        <ul>\n          ").concat(this.returnOptions(e),"\n        </ul>\n      </div>")},options:function(e){var t=e.rightAnswer,n=t?'<span class="right-option-gou"></span>':"",i=t?"right-color":"normal-color";return'\n      <li class="result-options-wrap">\n        <div class="result-percent-head '.concat(t?"right-hover-color":"normal-hover-color",'" style="width: ').concat(x()(e.percent),'%"></div>\n        <div class="result-full"></div>\n        <div class="result-percent-total">\n          ').concat(n,'\n          <span class="result-options-list">').concat("ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e.index),". ").concat(e.option,'</span>\n          <span class="result-options-percent ').concat(i,'">').concat(e.count,"票 (").concat(e.percent,"%}</span>\n        </div>\n      </li>\n    ")},returnOptions:function(e){var n=this;return this.getOptionsDetail(e).reduce(function(e,t){return"".concat(e).concat(n.options(t))},"")},getMainContent:function(e){var n=this;return e.reduce(function(e,t){return"".concat(e).concat(n.qnContent(t)).trim()},"")},getSingleOptionPercent:function(e,t){return 0===Number(t)?0:I()(100*e/t).toFixed(2)},returnIsAnswer:function(e,t){return-1!==e.split("").map(function(e){return e.toUpperCase().charCodeAt()-65}).join("").indexOf(t)},getOptionsDetail:function(n){var i=this,s=[],r=n.answerResult;return u()(n).filter(function(e){return 0===e.indexOf("option")&&n[e]}).forEach(function(e,t){s.push({option:n[e],percent:i.getSingleOptionPercent(r[t],n.total),rightAnswer:i.returnIsAnswer(n.answer,t),index:t,count:r[t]})}),s},getScore:function(e){var t=0,n=0;e.data.forEach(function(e){"Q"!==e.type&&(t+=Number(e.score),n+=Number(e.totalScore))});var i=I()(n/e.total).toFixed(2);return{totalScore:t,averageScore:i}}},W="ABCDEFGHIJKLMNOPQRSTUVWXYZ",O={parseString:function(e){return e&&"number"!=typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim():e},layout:function(e,t){e.questions;var n=e.title,i=void 0===n?"":n,s=t?"live-questionnaire-pc":"live-questionnaire-mobile",r=t?"":'<div class="live-questionnaire-head">\n    '.concat(this.parseString(i),'\n    <span data-type="close">×</span>\n    </div>'),a=document.createElement("div");return a.setAttribute("class","live-questionnaire ".concat(s)),a.innerHTML="\n    ".concat(r,'\n    <div class="live-questionnaire-container">\n      <div class="live-questionnaire-content js-questionnaireContent">\n\n      </div>\n    </div>').trim(),a},option:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length?arguments[2]:void 0;return t=this.parseString(t),'\n    <div class="live-questionnaire-option live-questionnaire-option-'.concat(e,'" title="').concat(t,'" data-answer="').concat(W[n],'">\n      <span>').concat(W[n],".").concat(t,"</span>\n    </div>\n    ").trim()},textarea:function(){return"\n      <textarea></textarea>\n    ".trim()},btn:function(){var e=document.createElement("div");return e.setAttribute("class","live-questionnaire-foot"),e.innerHTML='<span data-type="submit">提交</span>',e},question:function(n){var e,i=this;if("Q"===n.type)e=this.textarea();else{var s=[];n.options.forEach(function(e,t){t%2==0?s.push([e]):s[s.length-1].push(e)});var r=0;e=s.reduce(function(e,t){return"".concat(e,'<div class="live-questionnaire-question-col">').concat(i.option(n.type,t[0],r++)).concat(t[1]?i.option(n.type,t[1],r++):"","</div>")},"")}var t=document.createElement("div");return t.setAttribute("class","live-questionnaire-question"),t.innerHTML='<div class="live-questionnaire-question-head">'.concat(n.index,"、").concat(this.parseString(n.name),"<sup>").concat(n.required?"*":"","</sup>").concat("C"===n.type?" <span>(多选)</span>":"",'</div>\n      <div class="live-questionnaire-question-error ppt-hide js-questionnaireError"><span>这道题必填哦</span></div>\n      <div class="js-questionnaireOption">').concat(e,"</div>").trim(),t},tips:function(e){var t=document.createElement("div");return t.setAttribute("class","live-questionnaire-tips"),t.textContent=e,t}},B=function(e){function i(e){var t,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return r()(this,i),(t=c()(this,p()(i).call(this))).visible=!1,t.el=document.getElementById(e),t.id,t.isClient=n,t.config={},t.idLists=[],"function"!=typeof t.config.startCallback&&(t.config.startCallback=function(){}),"function"!=typeof t.config.endCallback&&(t.config.endCallback=function(){}),"function"!=typeof t.config.successCallback&&(t.config.successCallback=function(){}),t}return v()(i,e),o()(i,[{key:"singleHandler",value:function(e,t,n){n.answer!==t&&(n.currentEl&&n.currentEl.classList.remove("checked"),n.required&&n.showError&&(n.showError=!1,n.tips.classList.add("ppt-hide")),e.classList.add("checked"),n.answer=t,n.currentEl=e)}},{key:"multiHandler",value:function(e,t,n){n.answer||(n.answer={}),n.answer[t]?(e.classList.remove("checked"),delete n.answer[t]):(e.classList.add("checked"),n.answer[t]=!0),n.required&&n.showError&&0<u()(n.answer).length&&(n.showError=!1,n.tips.classList.add("ppt-hide"))}},{key:"askHandler",value:function(e,t){e.querySelector("textarea").addEventListener("change",function(e){t.answer=e.target.value.trim(),t.required&&t.showError&&t.answer&&(t.showError=!1,t.tips.classList.add("ppt-hide"))})}},{key:"initOptionHandler",value:function(s){var r=this;"Q"===s.type?this.askHandler(s.el,s):s.el.addEventListener("click",function(e){for(var t,n=e.target,i=!0;i;){if((t=n.getAttribute("data-answer"))||n===s.el){i=!1;break}n=n.parentNode}t&&("R"===s.type?r.singleHandler(n,t,s):r.multiHandler(n,t,s))})}},{key:"initBtnHandler",value:function(){var c=this;this.data.el.addEventListener("click",function(e){for(var t,n=e.target,i=!0;i;){if((t=n.getAttribute("data-type"))||n===c.data.el){i=!1;break}n=n.parentNode}if(t){var s=c.data.el.querySelector(".live-questionnaire-container");if("close"===t&&(c.remove(),c.emit("stopQuestionNaire"),c.config.endCallback()),"submit"===t){if(!c.data.allow)return;var r=[],a=!0,o=!1;if(c.data.questions.forEach(function(e){var t=e.answer;"C"===e.type&&(t=t||{},t=u()(t).sort().join("")),"Q"===e.type&&(t=O.parseString(t)),e.required&&!t?(a=!1,e.tips.classList.remove("ppt-hide"),e.showError=!0,o||(s.scrollTop=e.el.offsetTop-60,o=!0)):r.push({questionId:e.id,answer:t})}),!a)return;var l=c.data.id;c.showTips("提交成功","success",function(){c.emit("endQuestionnaireAnswer",{id:l,answers:r}),c.el.classList.add("ppt-hide")}),c.remove()}}})}},{key:"showTips",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"success",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},s=O.tips(e);s.classList.add("live-questionnaire-tips-".concat(n)),this.el.appendChild(s),setTimeout(function(){t.el.removeChild(s),i()},2e3)}},{key:"remove",value:function(){this.el.removeChild(this.data.el),this.data=void 0}},{key:"render",value:function(){var t=this,e=O.layout(this.data,this.isClient),n=e.querySelector(".js-questionnaireContent");this.data.questions.forEach(function(e){e.el=O.question(e),e.tips=e.el.querySelector(".js-questionnaireError"),n.appendChild(e.el),t.initOptionHandler(e)}),this.data.btn=O.btn(),n.appendChild(this.data.btn),this.el.appendChild(e),this.data.el=e,this.initBtnHandler()}},{key:"formatQuestions",value:function(e){return e.map(function(n,e){return{required:"Y"===n.required,type:n.type,name:O.parseString(n.name),id:n.questionId,index:e+1,options:A()(new Array(10)).map(function(e,t){return n["option".concat(t+1)]}).filter(function(e){return!!O.parseString(e)})}})}},{key:"startQuestionNaire",value:function(e){if(this.el.classList.remove("ppt-hide"),-1===this.idLists.indexOf(e.questionnaireId)){if(this.data){if(this.data.id===e.content.questionnaireId)return;this.remove()}this.config.startCallback(),this.data={title:O.parseString(e.content.questionnaireTitle),id:e.content.questionnaireId,questions:this.formatQuestions(e.content.questions),allow:!0},this.render()}}},{key:"stopQuestionNaire",value:function(e){var t=this;this.idLists.push(e.questionnaireId),this.data?(this.showTips("问卷已截止","stop",function(){t.emit("stopQuestionNaire")}),this.remove()):this.emit("stopQuestionNaire")}},{key:"returnResutQuestionnaire",value:function(e){var t=this,n=Q.mainTmp(e);this.el.classList.remove("ppt-hide"),this.el.appendChild(n),document.getElementById("questionnaireResultClose").addEventListener("click",function(){t.el.removeChild(n),t.emit("stopQuestionNaire")})}}]),i}(f.a),R=n(74),M=n.n(R);n(145);var P,J,V,D="3"===("version",P=window.location.search,J=new RegExp("(^|&)".concat("version","=([^&]*)(&|$)")),(V=P.substr(1).match(J))?decodeURIComponent(V[2].replace(/\s*/g,"")):null),j=function(e){function n(e){var t;return r()(this,n),(t=c()(this,p()(n).call(this))).specailCh=!1,t.wrongNum=!1,t.addressLegal=!0,t.visible=!1,t.nameValue=null,t.telephoneNumber=null,t.addressValue=null,t.timer=null,t.wrap=document.getElementById(e),t.bindEvent(),t}return v()(n,e),o()(n,[{key:"startLottery",value:function(e){var t;this.closeElement(),this.visible=!0,this.el=((t=document.createElement("div")).setAttribute("class","lottery-start-content el-lottery-content"),t.innerHTML='<span class="lottery-start-gif">正在抽奖</span>\n      <span class="lottery-start-close" data-type="close">×</span>',t),this.wrap.appendChild(this.el),this.wrap.classList.add("lottery-show")}},{key:"winLottery",value:function(e){this.el=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{prize:"",winnerCode:""},t=document.createElement("div");return t.setAttribute("class","lottery-main-container el-lottery-content"),t.innerHTML='\n      <span class="lottery-main-close" data-type="lottery-close">×</span>\n      <div class="lottery-main-head">\n        <p>中奖啦</p>\n        <p>'.concat(e.prize,"</p>\n        <span>兑换码：").concat(e.winnerCode,'</span>\n      </div>\n      <p>—— 请提交以下信息，后续有专人联系您兑奖 ——</p>\n      <div class="lottery-submit-data">\n        <input class="lottery-name" id="lotteryName" type="text" placeholder="请输入真实姓名">\n        <input class="lottery-tel" id="lotteryTel" type="text" placeholder="请输入手机号码">\n        ').concat(D?'<input class="lottery-adr" id="lotteryAdr" type="text" placeholder="请输入收件地址">':"",'\n      </div>\n      <button class="lottery-submit" id="lotterySubmit" data-type="submit-lottery">提交</button>\n    '),t}(e),this.wrap.appendChild(this.el);var t=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.setAttribute("class","lottery-prompt ppt-hide"),t.innerHTML=e,t}();this.el.appendChild(t),this.promptEl=document.getElementsByClassName("lottery-prompt")[0],this.inputCheck()}},{key:"notWinLottery",value:function(){var e;this.el=((e=document.createElement("div")).setAttribute("class","lottery-not-win el-lottery-content"),e.innerHTML='\n      <p>很遗憾您未中奖</p>\n      <button data-type="close-webview">知道了</>\n    ',e),this.wrap.appendChild(this.el)}},{key:"stopLottery",value:function(e){this.closeElement(),this.visible=!0,e.win?this.winLottery(e):this.notWinLottery(),this.wrap.classList.add("lottery-show")}},{key:"closeElement",value:function(){document.getElementsByClassName("el-lottery-content")[0]&&(this.el.remove(),this.el=null,this.wrap.classList.remove("lottery-show"))}},{key:"closeLotteryWinner",value:function(){confirm("确认放弃领取奖品？")&&(this.emit("abandonLottery"),this.closeElement(),this.emit("closeLotteryWebview"))}},{key:"bindEvent",value:function(){var i=this;this.wrap.addEventListener("click",function(e){var t=e.target.getAttribute("data-type");if(t)switch(t){case"close":i.closeElement(),i.emit("closeLotteryWebview");break;case"submit-lottery":if(i.checkAllowSubmit()){i.tipsShow("请填写正确信息");break}var n={name:i.nameValue,telephone:i.telephoneNumber};D&&(n.address=i.addressValue),i.emit("sendWinData",n),i.tipsShow("提交成功").then(function(){i.closeElement(),i.emit("closeLotteryWebview")});break;case"lottery-close":confirm("确认放弃领取奖品？")&&(i.emit("abandonLottery"),i.closeElement(),i.emit("closeLotteryWebview"));break;case"close-webview":i.closeElement(),i.emit("closeLotteryWebview")}})}},{key:"blur",value:function(){var e=document.getElementById("lotteryName"),t=document.getElementById("lotteryTel");e&&e.blur(),t&&t.blur()}},{key:"tipsShow",value:function(e){var t=this;return this.promptEl.innerHTML=e,this.promptEl.classList.remove("ppt-hide"),new M.a(function(e){clearTimeout(t.timer),t.timer=setTimeout(function(){t.promptEl.classList.add("ppt-hide"),e()},3e3)})}},{key:"checkAllowSubmit",value:function(){return this.specailCh||this.wrongNum||!this.nameValue||!this.telephoneNumber||!this.addressLegal}},{key:"checkSpecailChar",value:function(e){return!!e.match(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]"].join("|"))}},{key:"inputCheck",value:function(){var n=this,i=document.getElementById("lotteryName"),s=document.getElementById("lotteryTel");this.nameValue="",this.telephoneNumber="",this.addressValue="",i.addEventListener("blur",function(e){var t=e.target.value;10<t.length&&(t=t.substr(0,10),i.value=t),n.specailCh=n.checkSpecailChar(t),n.specailCh&&n.tipsShow("不可输入特殊字符"),n.nameValue=t}),s.addEventListener("keyup",function(e){var t=e.target.value;s.value=t.replace(/[^0-9.]/g,""),11<t.length&&(t=t.substr(0,11),s.value=t)}),s.addEventListener("blur",function(e){var t=e.target.value;/^1\d{10}$/.test(t)&&/^1[3456789]\d{9}$/.test(t)?n.wrongNum=!1:(n.tipsShow("请输入正确号码"),n.wrongNum=!0),n.telephoneNumber=t}),D&&document.getElementById("lotteryAdr").addEventListener("blur",function(e){var t=e.target.value;n.addressLegal=!n.checkSpecailChar(t),console.log(n.addressLegal,t),n.addressLegal||n.tipsShow("不可输入特殊字符"),n.addressValue=t})}}]),n}(f.a),z=(n(146),function(e){var t=document.createElement("div");return t.className="player-signed-container",t.innerHTML='\n      <span data-type="close">×</span>\n      <div class="signed-time" id="signTime">'.concat(e.limitTime,'</div>\n      <p class="sign-message">').concat(e.message,'</p>\n      <button class="btn-signed" data-type="sign-in" id="btnSign">签到</buttton>\n    '),t}),Z=function(e){function n(e){var t;return r()(this,n),(t=c()(this,p()(n).call(this))).signTimer=null,t.wrap=document.getElementById(e),t.visible=!1,t.bindEvent(),t}return v()(n,e),o()(n,[{key:"startSign",value:function(e){this.wrapClose(),this.visible=!0,this.el=z(e),this.wrap.appendChild(this.el),this.wrap.classList.add("sign-show"),this.signTime=document.getElementById("signTime"),this.btnSign=document.getElementById("btnSign"),this.startCountDown(Number(e.limitTime))}},{key:"stopSign",value:function(){var e=this;clearInterval(this.signTimer),this.btnSign&&(this.visible=!0,this.btnSign.setAttribute("class","btn-sign-stop"),this.btnSign.setAttribute("disabled","disabled"),this.btnSign.innerHTML="签到已截止",setTimeout(function(){e.wrapClose(),e.emit("closeSignWebview")},3e3))}},{key:"startCountDown",value:function(n){var i=this;clearInterval(this.signTimer);var s=(new Date).getTime();this.signTimer=setInterval(function(){var e=(new Date).getTime()-s,t=n-x()(e/1e3,10);(i.signTime.innerHTML=t)<1&&i.stopSign()},500)}},{key:"wrapClose",value:function(){document.getElementsByClassName("player-signed-container")[0]&&(this.el.remove(),this.el=null,this.wrap.classList.remove("sign-show"))}},{key:"bindEvent",value:function(){var i=this;this.wrap.addEventListener("click",function(e){var t=e.target.getAttribute("data-type");if(t)if("sign-in"===t){clearInterval(i.signTimer),i.timmer=null;var n=i.btnSign;signTime.innerHTML='<span class="submit-sign"></span>',n.setAttribute("class","btn-sign-submit"),n.setAttribute("disabled","disabled"),n.innerHTML="签到成功",i.emit("submitSign"),setTimeout(function(){i.wrapClose(),i.emit("closeSignWebview")},3e3)}else"close"===t&&(clearInterval(i.signTimer),i.wrapClose(),i.emit("closeSignWebview"))})}}]),n}(f.a),_=(n(147),function(e){function i(e,t){var n;return r()(this,i),(n=c()(this,p()(i).call(this))).visible=!1,n.isPc=t||!1,n.el=document.getElementById(e),n.els=k()(n.el.querySelectorAll("[data-el]")).reduce(function(e,t){return e[t.getAttribute("data-el")]=t,e},{}),n.bindCloseEvent(),n}return v()(i,e),o()(i,[{key:"bindCloseEvent",value:function(){var e=this,t=function(){e.hide(),e.emit("close"),e.remove()};!this.isPc&&this.els.close.addEventListener("click",t),this.els.know.addEventListener("click",t)}},{key:"show",value:function(){this.visible=!0,this.el.classList.remove("ppt-hide")}},{key:"hide",value:function(){this.visible=!1,this.el.classList.add("ppt-hide")}},{key:"append",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.els.content.innerHTML=e||"暂无公告",t&&this.show()}},{key:"remove",value:function(){this.append("",!1)}}]),i}(f.a)),F=(n(148),function(e){function i(e,t){var n;return r()(this,i),(n=c()(this,p()(i).call(this))).visible=!1,n.isPc=t||!1,n.el=document.getElementById(e),n.els=k()(n.el.querySelectorAll("[data-el]")).reduce(function(e,t){return e[t.getAttribute("data-el")]=t,e},{}),n.bindCloseEvent(),n}return v()(i,e),o()(i,[{key:"bindCloseEvent",value:function(){var e=this,t=function(){e.hide()};!this.isPc&&this.els.close.addEventListener("click",t),this.els.know.addEventListener("click",t)}},{key:"show",value:function(){this.visible=!0,this.el.classList.remove("ppt-hide")}},{key:"hide",value:function(){this.visible=!1,this.el.classList.add("ppt-hide"),this.append("",!1),this.emit("close")}},{key:"append",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.els.content.innerHTML=e||"",t&&this.show()}}]),i}(f.a));new(function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r()(this,i),this.answer=new q(e.answerCard),this.questionnaire=new B(e.questionnaire),this.lottery=new j(e.lottery),this.sign=new Z(e.sign),this.announcement=new _(e.announcement),this.pauseTip=new F(e.pauseTip),this.hideClass="ppt-hide",this.zIndex=10,this.eventLists=null,this.bindBridgeEvents(),this.bindAnswerEvent(),this.bindQuestionnaireEvent(),this.bindLotteryEvent(),this.bindSignEvent(),this.bindAnnouncementEvent(),this.bindPauseTipEvent()}return o()(i,[{key:"bridgeEvents",value:function(){var n=this;return{updateNewQuestion:function(e){n.answer.visible=!0,i.setZIndex(n.answer.wrap,++n.zIndex),n.answer.updateNewQuestion(JSON.parse(e)),n.lottery.blur()},hasChooseAnswer:function(e){try{var t=JSON.parse(e);n.answer.visible=!0,i.setZIndex(n.answer.wrap,++n.zIndex),n.answer.hasChooseAnswer(t.answerId,t.data),n.lottery.blur()}catch(e){}},extraQuestionMessageHandler:function(e){var t=JSON.parse(e);"S"!==t.type&&"STOP_TEST_QUESTION"===t.EVENT&&(n.answer.visible=!0,i.setZIndex(n.answer.wrap,++n.zIndex),n.answer.stopQuestion(t),n.lottery.blur())},startQuestionNaire:function(e){n.questionnaire.visible=!0,i.setZIndex(n.questionnaire.el,++n.zIndex),n.questionnaire.startQuestionNaire(JSON.parse(e)),n.lottery.blur()},stopQuestionNaire:function(e){n.questionnaire.visible=!0,n.questionnaire.stopQuestionNaire(JSON.parse(e))},startLottery:function(){n.lottery.visible=!0,n.lottery.startLottery(),i.setZIndex(n.lottery.wrap,++n.zIndex)},stopLottery:function(e){n.lottery.visible=!0,n.lottery.stopLottery(JSON.parse(e))},closeLotteryWinner:function(){n.lottery.closeLotteryWinner()},startSign:function(e){n.sign.visible=!0,n.sign.startSign(JSON.parse(e)),i.setZIndex(n.sign.wrap,++n.zIndex),n.lottery.blur()},stopSign:function(){n.sign.stopSign()},bulletin:function(e){n.announcement.append(JSON.parse(e).content)},removeBulletin:function(){n.announcement.remove()},onStartRecord:function(){n.pauseTip.hide()},onPauseRecord:function(e){n.pauseTip.append(JSON.parse(e).tip)},onExitRecord:function(){n.pauseTip.hide()}}}},{key:"bindBridgeEvents",value:function(){var t=this;this.eventLists=this.bridgeEvents(),u()(this.eventLists).forEach(function(e){g.on(e,t.eventLists[e])})}}],[{key:"setZIndex",value:function(e,t){e.style.zIndex=t}}]),o()(i,[{key:"closeWebview",value:function(){this.answer.visible||this.questionnaire.visible||this.sign.visible||this.lottery.visible||this.announcement.visible||this.pauseTip.visible||g.closeWebview()}},{key:"bindAnswerEvent",value:function(){var t=this;this.answer.on("knowAnswer",function(){t.answer.visible=!1,t.closeWebview()}),this.answer.on("chooseAnswer",function(e){g.chooseAnswer(e),t.answer.visible=!1,t.closeWebview()})}},{key:"bindQuestionnaireEvent",value:function(){var t=this;this.questionnaire.on("endQuestionnaireAnswer",function(e){g.endQuestionnaireAnswer(e),t.questionnaire.visible=!1,t.closeWebview()}),this.questionnaire.on("stopQuestionNaire",function(){t.questionnaire.el.classList.add(t.hideClass),t.questionnaire.visible=!1,t.closeWebview()})}},{key:"bindLotteryEvent",value:function(){var t=this;this.lottery.on("sendWinData",function(e){t.lottery.visible=!1,g.sendWinData(e)}),this.lottery.on("abandonLottery",function(e){t.lottery.visible=!1,g.abandonLottery()}),this.lottery.on("closeLotteryWebview",function(){t.lottery.visible=!1,t.closeWebview()}),/iPad|iPhone|iPod/i.test(navigator.userAgent)&&window.addEventListener("orientationchange",function(){t.lottery.blur()},!1)}},{key:"bindSignEvent",value:function(){var e=this;this.sign.on("submitSign",function(){e.sign.visible=!1,g.submitSign()}),this.sign.on("closeSignWebview",function(){e.sign.visible=!1,e.closeWebview()})}},{key:"bindAnnouncementEvent",value:function(){this.announcement.on("close",this.closeWebview.bind(this))}},{key:"bindPauseTipEvent",value:function(){this.pauseTip.on("close",this.closeWebview.bind(this))}}]),i}())({answerCard:"answerCard",questionnaire:"questionnaire",lottery:"lottery",sign:"sign",announcement:"announcement",pauseTip:"pauseTip"})},82:function(e,t,n){}});